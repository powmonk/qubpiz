<div>
  <h1>MC Control Panel</h1>
  
  <div class="quiz-actions">
    <button (click)="showQuizList = !showQuizList" class="select-btn">
      {{ showQuizList ? 'Hide Quiz List' : 'Select Quiz' }}
    </button>
    <button (click)="showNewQuizForm = !showNewQuizForm" class="create-btn">
      {{ showNewQuizForm ? 'Cancel Creation' : 'Create New Quiz' }}
    </button>
  </div>

  <div *ngIf="showQuizList" class="quiz-list">
    <h3>All Quizzes</h3>
    <div *ngIf="allQuizzes.length === 0" class="no-quizzes">
      No quizzes created yet.
    </div>
    <ul>
      <li *ngFor="let quiz of allQuizzes" (click)="selectQuiz(quiz.id)" 
          [class.active]="currentQuiz?.id === quiz.id">
        <div class="quiz-item">
          <strong>{{ quiz.quiz_name }}</strong>
          <span class="quiz-date">{{ quiz.quiz_date | date:'mediumDate' }}</span>
          <button (click)="deleteQuiz(quiz.id, $event)" class="delete-btn-small">Ã—</button>
        </div>
      </li>
    </ul>
  </div>

  <div *ngIf="showNewQuizForm" class="quiz-form">
    <h3>Create New Quiz</h3>
    <label>Quiz Name</label>
    <input 
      type="text" 
      [(ngModel)]="newQuizName" 
      placeholder="e.g., Pub Quiz - October 21st"
    />
    
    <label>Quiz Date</label>
    <input 
      type="date" 
      [(ngModel)]="newQuizDate"
    />
    
    <button (click)="createQuiz()" class="save-btn">Create Quiz</button>
  </div>

  <div *ngIf="currentQuiz" class="current-quiz">
    <h2>{{ currentQuiz.quiz_name }}</h2>
    <p class="quiz-date-display">{{ currentQuiz.quiz_date | date:'fullDate' }}</p>
    
    <div class="game-status-panel">
      <button (click)="toggleGameStatus()" 
              [ngClass]="{
                'start-game-btn': currentQuiz.status === 'waiting' || currentQuiz.status === 'closed', 
                'end-game-btn': currentQuiz.status === 'active'
              }">
        <span *ngIf="currentQuiz.status === 'waiting'">Start Game & Open Lobby</span>
        <span *ngIf="currentQuiz.status === 'active'">Close Lobby (Game Running)</span>
        <span *ngIf="currentQuiz.status === 'closed'">Re-Open Lobby (Game Running)</span>
      </button>
      <p>Status: <strong>{{ currentQuiz.status | uppercase }}</strong></p>
    </div>
    
    <div class="player-management">
      <h3>Players in Game ({{ players.length }})</h3>
      <div *ngIf="players.length === 0" class="no-players">
        No players have joined yet.
      </div>
      <ul class="player-list">
        <li *ngFor="let player of players">
          <span>{{ player }}</span>
          <button (click)="removePlayer(player)" class="remove-player-btn">Remove</button>
        </li>
      </ul>
      <button (click)="resetGame()" class="reset-btn">Clear All Players</button>
    </div>
    <app-round-manager 
      [currentQuizId]="currentQuiz.id"
      (roundSelected)="onRoundSelected($event)">
    </app-round-manager>
    
    <app-question-manager 
      *ngIf="selectedRound"
      [currentRound]="selectedRound">
    </app-question-manager>
  </div>

  <div *ngIf="!currentQuiz && !showNewQuizForm && !showQuizList" class="no-selection">
    <p>Select an existing quiz or create a new one to get started.</p>
  </div>
</div>